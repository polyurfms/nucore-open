
= content_for :h1 do
  = t("views.request_endorsements.header")
= error_messages_for :user

= content_for :tabnav do
  %ul.nav.nav-tabs
    = tab "My Profile", edit_current_profile_path, (@current_type == "my_profile")
    - if @count > 0
      = tab "My Assistant", user_delegations_path, (@current_type == "my_delegation")
    - if session_user.is_academic != true
      = tab "Request Endorsements", request_endorsements_path, (@current_type == "request_endorsements")

- if @can_request
  <br>

  %button{:onclick => "show_search_form()", :type => "button", :class => "btn btn-primary", :id => "show_search_btn"} Request Endorsements

  <div id="search_form" style="display: none;">
  %h2= t(".head.h2")
  = form_tag supervisor_user_search_results_path, id: "ajax_form", method: :get do
    = label_tag :search_term, t(".label.search_term")
    %br
    = text_field_tag :search_term, nil, size: 30, class: "search-query"
    = submit_tag "Search", class: "btn"
  %br

  #result

  </div>

<br>
<br>

%h4= t("views.request_endorsements.table_name")

%table.table.table-striped.table-hover
  %thead
    %tr
      %th= t("views.request_endorsements.supervisor")
      %th= t("views.request_endorsements.date")
      %th= t("views.request_endorsements.status")
      %th= ""
  %tbody
    - @request_endorsement.each do |request|
      %tr
        %td= request.supervisor
        %td= request.created_at.strftime("%d %b %Y %-l:%M %p")
        - unless request.deleted_at.nil?
          %td= "Deleted"
          %td
            -# %p= ""
        - else
          - if request.is_accepted.nil?
            - if request.created_at.to_datetime + 1.days > Time.zone.now.to_datetime
              %td= "Process"
              %td
                %p= link_to t("views.request_endorsements.remove"), request_endorsement_path(request), method: :delete, data: { confirm: text("views.request_endorsements.delete_msg") } 
            - else 
              %td= "Expired" 
              %td
                -# %p= ""
          - else 
            - if request.is_accepted == false
              %td= "Rejected" 
              %td 
                %p= ""
            - else 
              %td= "Approved" if request.is_accepted == true
              %td 
                %p= ""
            

:javascript
  function show_search_form(){
    document.getElementById("search_form").style.display = "block";
    document.getElementById("show_search_btn").style.display = "none";
  }